# SportsCoder νƒ€μ΄λ¨Έ μ‹μ¤ν… μ•„ν‚¤ν…μ²

## π“‹ λ©μ°¨
1. [μ‹μ¤ν… κ°μ”](#μ‹μ¤ν…-κ°μ”)
2. [μ•„ν‚¤ν…μ² μ„¤κ³„](#μ•„ν‚¤ν…μ²-μ„¤κ³„)
3. [ν•µμ‹¬ μ»΄ν¬λ„νΈ](#ν•µμ‹¬-μ»΄ν¬λ„νΈ)
4. [λ°μ΄ν„° νλ¦„](#λ°μ΄ν„°-νλ¦„)
5. [WebSocket μ΄λ²¤νΈ μ‹μ¤ν…](#websocket-μ΄λ²¤νΈ-μ‹μ¤ν…)
6. [λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ΅°](#λ°μ΄ν„°λ² μ΄μ¤-κµ¬μ΅°)
7. [ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ™κΈ°ν™”](#ν΄λΌμ΄μ–ΈνΈ-μ„λ²„-λ™κΈ°ν™”)
8. [νƒ€μ΄λ¨Έ μƒνƒ κ΄€λ¦¬](#νƒ€μ΄λ¨Έ-μƒνƒ-κ΄€λ¦¬)
9. [μ¤λ¥ μ²λ¦¬ λ° λ³µκµ¬](#μ¤λ¥-μ²λ¦¬-λ°-λ³µκµ¬)
10. [μ„±λ¥ μµμ ν™”](#μ„±λ¥-μµμ ν™”)
11. [ν…μ¤νΈ λ° κ²€μ¦](#ν…μ¤νΈ-λ°-κ²€μ¦)

## π― μ‹μ¤ν… κ°μ”

### ν•µμ‹¬ λ©ν‘
- **μ„λ²„ μ¤‘μ‹¬ νƒ€μ΄λ¨Έ**: μ„λ²„κ°€ μ μΌν• μ‹κ°„ κΈ°μ¤€μ΄ λλ” λ‹¨μν• νƒ€μ΄λ¨Έ μ‹μ¤ν…
- **μ‹¤μ‹κ°„ λ™κΈ°ν™”**: μ»¨νΈλ΅¤ νμ΄μ§€μ™€ μ¤λ²„λ μ΄ νμ΄μ§€ κ°„ μ™„λ²½ν• λ™κΈ°ν™”
- **μ§€μ†μ„± λ³΄μ¥**: μ„λ²„ μ¬μ‹μ‘ ν›„μ—λ„ νƒ€μ΄λ¨Έ μƒνƒ λ³µμ›
- **ν¬λ΅μ¤ ν”λ«νΌ**: λ‹¤λ¥Έ PCμ—μ„λ„ λ™μΌν• νƒ€μ΄λ¨Έ μƒνƒ μ μ§€

### μ£Όμ” νΉμ§•
- **λ‹¨μΌ νƒ€μ΄λ¨Έ μ‹μ¤ν…**: κΈ°μ΅΄ V2 λ²„μ „ μ κ±°, ν•λ‚μ ν†µν•©λ μ‹μ¤ν…
- **μ„λ²„ μ¤‘μ‹¬ μ„¤κ³„**: ν΄λΌμ΄μ–ΈνΈλ” ν‘μ‹λ§ λ‹΄λ‹Ή, μ„λ²„κ°€ λ¨λ“  λ΅μ§ μ²λ¦¬
- **WebSocket κΈ°λ°**: μ‹¤μ‹κ°„ μ–‘λ°©ν–¥ ν†µμ‹ 
- **λ°μ΄ν„°λ² μ΄μ¤ μμ†μ„±**: SQLite/PostgreSQLμ„ ν†µν• μƒνƒ μ €μ¥

## π—οΈ μ•„ν‚¤ν…μ² μ„¤κ³„

### μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    SportsCoder νƒ€μ΄λ¨Έ μ‹μ¤ν…                β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  ν΄λΌμ΄μ–ΈνΈ κ³„μΈµ (Client Layer)                              β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚ μ»¨νΈλ΅¤ νμ΄μ§€    β”‚  β”‚ μ¤λ²„λ μ΄ νμ΄μ§€  β”‚  β”‚ λ¨λ°”μΌ μ»¨νΈλ΅¤    β”‚ β”‚
β”‚  β”‚ (soccer-control)β”‚  β”‚ (soccer-template)β”‚  β”‚ (soccer-control-β”‚ β”‚
β”‚  β”‚                 β”‚  β”‚                 β”‚  β”‚ mobile)        β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  ν†µμ‹  κ³„μΈµ (Communication Layer)                            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚              WebSocket (Socket.IO)                      β”‚ β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”‚ timer_state β”‚  β”‚ timer_controlβ”‚  β”‚ join_match   β”‚    β”‚ β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ„λ²„ κ³„μΈµ (Server Layer)                                    β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚              Express.js Server                         β”‚ β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”‚ λΌμ°ν„°       β”‚  β”‚ λ―Έλ“¤μ›¨μ–΄     β”‚  β”‚ μ»¨νΈλ΅¤λ¬     β”‚    β”‚ β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  λΉ„μ¦λ‹μ¤ λ΅μ§ κ³„μΈµ (Business Logic Layer)                  β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚              νƒ€μ΄λ¨Έ μ΄λ²¤νΈ ν•Έλ“¤λ¬                        β”‚ β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”‚ startTimer   β”‚  β”‚ stopTimer    β”‚  β”‚ resetTimer   β”‚    β”‚ β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”‚ setTimer     β”‚  β”‚ broadcastStateβ”‚  β”‚ saveToDB     β”‚    β”‚ β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  λ°μ΄ν„° κ³„μΈµ (Data Layer)                                    β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚              λ°μ΄ν„°λ² μ΄μ¤ (SQLite/PostgreSQL)          β”‚ β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β”‚  β”‚ Matches      β”‚  β”‚ match_data   β”‚  β”‚ timer_state  β”‚    β”‚ β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## π”§ ν•µμ‹¬ μ»΄ν¬λ„νΈ

### 1. μ„λ²„ μ¤‘μ‹¬ νƒ€μ΄λ¨Έ ν΄λμ¤ (`websocket/events/timer.js`)

#### ServerCentricTimer ν΄λμ¤
```javascript
class ServerCentricTimer {
    constructor() {
        this.timerStates = global.serverTimerStates; // μ „μ—­ νƒ€μ΄λ¨Έ μƒνƒ κ΄€λ¦¬
    }
    
    // ν•µμ‹¬ λ©”μ„λ“λ“¤
    startTimer(matchId, io)     // νƒ€μ΄λ¨Έ μ‹μ‘
    stopTimer(matchId, io)      // νƒ€μ΄λ¨Έ μ •μ§€
    resetTimer(matchId, io)     // νƒ€μ΄λ¨Έ λ¦¬μ…‹
    setTimer(matchId, minutes, seconds, io) // νƒ€μ΄λ¨Έ μ„¤μ •
    getCurrentTime(matchId)     // ν„μ¬ μ‹κ°„ κ³„μ‚°
    broadcastTimerState(matchId, io) // μƒνƒ λΈλ΅λ“μΊμ¤νΈ
    saveToDatabase(matchId)     // λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥
    restoreFromDatabase(matchId) // λ°μ΄ν„°λ² μ΄μ¤ λ³µμ›
}
```

#### νƒ€μ΄λ¨Έ μƒνƒ κµ¬μ΅°
```javascript
{
    startTime: 1760502130128,    // μ„λ²„ μ‹μ‘ μ‹κ°„ (λ°€λ¦¬μ΄)
    pausedTime: 156,             // μ •μ§€λ μ‹κ°„ (μ΄)
    isRunning: true,             // μ‹¤ν–‰ μƒνƒ
    lastUpdate: 1760502130128    // λ§μ§€λ§‰ μ—…λ°μ΄νΈ μ‹κ°„
}
```

### 2. WebSocket μ΄λ²¤νΈ μ‹μ¤ν…

#### μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ μ΄λ²¤νΈ
- **`timer_state`**: νƒ€μ΄λ¨Έ μƒνƒ μ „μ†΅
  ```javascript
  {
      matchId: "10128917",
      currentSeconds: 156,
      isRunning: true,
      serverTime: 1760502130128,
      pausedTime: 156,
      startTime: 1760502130128
  }
  ```

#### ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„ μ΄λ²¤νΈ
- **`request_timer_state`**: νƒ€μ΄λ¨Έ μƒνƒ μ”μ²­
- **`timer_control`**: νƒ€μ΄λ¨Έ μ μ–΄ (start, stop, reset, set)

### 3. ν΄λΌμ΄μ–ΈνΈ νƒ€μ΄λ¨Έ μ‹μ¤ν…

#### μ»¨νΈλ΅¤ νμ΄μ§€ (`views/soccer-control.ejs`)
```javascript
// νƒ€μ΄λ¨Έ μƒνƒ (μ™„μ „ λ‹¨μν™”)
let currentTime = 0;        // ν„μ¬ μ‹κ°„ (μ΄)
let isRunning = false;      // μ‹¤ν–‰ μƒνƒ

// ν•µμ‹¬ ν•¨μλ“¤
function startTimer()       // νƒ€μ΄λ¨Έ μ‹μ‘ μ”μ²­
function stopTimer()        // νƒ€μ΄λ¨Έ μ •μ§€ μ”μ²­
function resetTimer()       // νƒ€μ΄λ¨Έ λ¦¬μ…‹ μ”μ²­
function updateTimerDisplay() // νƒ€μ΄λ¨Έ ν‘μ‹ μ—…λ°μ΄νΈ
function startLocalTimer()  // λ΅μ»¬ νƒ€μ΄λ¨Έ μ‹μ‘
function stopLocalTimer()   // λ΅μ»¬ νƒ€μ΄λ¨Έ μ •μ§€
```

#### μ¤λ²„λ μ΄ νμ΄μ§€ (`views/soccer-template.ejs`)
```javascript
// μ„λ²„ νƒ€μ΄λ¨Έ μƒνƒ μμ‹ 
socket.on('timer_state', function(data) {
    // μ„λ²„ μƒνƒ μ—…λ°μ΄νΈ
    timerState.currentSeconds = data.currentSeconds || 0;
    timerState.isRunning = data.isRunning || false;
    timerState.startTime = data.startTime || null;
    timerState.pausedTime = data.pausedTime || 0;
    
    // νƒ€μ΄λ¨Έ λ””μ¤ν”λ μ΄ μ—…λ°μ΄νΈ
    updateTimerDisplay();
});
```

## π“ λ°μ΄ν„° νλ¦„

### 1. νƒ€μ΄λ¨Έ μ‹μ‘ νλ¦„
```
ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„ β†’ λ°μ΄ν„°λ² μ΄μ¤ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ
    β†“         β†“         β†“           β†“
startTimer β†’ startTimer β†’ saveToDB β†’ broadcastState
    β†“         β†“         β†“           β†“
μ”μ²­ μ „μ†΅ β†’ μƒνƒ μ—…λ°μ΄νΈ β†’ μμ†μ„± μ €μ¥ β†’ μ‹¤μ‹κ°„ λ™κΈ°ν™”
```

### 2. νƒ€μ΄λ¨Έ μ •μ§€ νλ¦„
```
ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„ β†’ λ°μ΄ν„°λ² μ΄μ¤ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ
    β†“         β†“         β†“           β†“
stopTimer β†’ stopTimer β†’ saveToDB β†’ broadcastState
    β†“         β†“         β†“           β†“
μ”μ²­ μ „μ†΅ β†’ μƒνƒ μ—…λ°μ΄νΈ β†’ μμ†μ„± μ €μ¥ β†’ μ‹¤μ‹κ°„ λ™κΈ°ν™”
```

### 3. νƒ€μ΄λ¨Έ λ¦¬μ…‹ νλ¦„
```
ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„ β†’ λ°μ΄ν„°λ² μ΄μ¤ β†’ λ¨λ“  ν΄λΌμ΄μ–ΈνΈ
    β†“         β†“         β†“           β†“
resetTimer β†’ resetTimer β†’ saveToDB β†’ broadcastState
    β†“         β†“         β†“           β†“
μ”μ²­ μ „μ†΅ β†’ μƒνƒ μ΄κΈ°ν™” β†’ μμ†μ„± μ €μ¥ β†’ μ‹¤μ‹κ°„ λ™κΈ°ν™”
```

## π”„ WebSocket μ΄λ²¤νΈ μ‹μ¤ν…

### μ΄λ²¤νΈ μ²λ¦¬ νλ¦„
```
1. ν΄λΌμ΄μ–ΈνΈ μ—°κ²°
   β†“
2. join_match μ΄λ²¤νΈ (κ²½κΈ° λ°© μ°Έμ—¬)
   β†“
3. request_timer_state μ΄λ²¤νΈ (μ΄κΈ° μƒνƒ μ”μ²­)
   β†“
4. timer_state μ΄λ²¤νΈ (μ„λ²„ μƒνƒ μ „μ†΅)
   β†“
5. timer_control μ΄λ²¤νΈ (νƒ€μ΄λ¨Έ μ μ–΄)
   β†“
6. broadcastTimerState (λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ— μƒνƒ μ „μ†΅)
```

### μ΄λ²¤νΈ ν•Έλ“¤λ¬ κµ¬μ΅°
```javascript
// μ„λ²„ μΈ΅ μ΄λ²¤νΈ ν•Έλ“¤λ¬
socket.on('request_timer_state', async (data) => {
    // μ΄κΈ° νƒ€μ΄λ¨Έ μƒνƒ μ”μ²­ μ²λ¦¬
});

socket.on('timer_control', async (data) => {
    // νƒ€μ΄λ¨Έ μ μ–΄ μ”μ²­ μ²λ¦¬
    switch (action) {
        case 'start': serverTimer.startTimer(matchId, io); break;
        case 'stop': serverTimer.stopTimer(matchId, io); break;
        case 'reset': serverTimer.resetTimer(matchId, io); break;
        case 'set': serverTimer.setTimer(matchId, minutes, seconds, io); break;
    }
});
```

## π—„οΈ λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ΅°

### Matches ν…μ΄λΈ”μ match_data ν•„λ“
```javascript
{
    // κΈ°μ΅΄ κ²½κΈ° λ°μ΄ν„°
    home_score: 0,
    away_score: 0,
    // ... κΈ°νƒ€ κ²½κΈ° λ°μ΄ν„°
    
    // νƒ€μ΄λ¨Έ μƒνƒ λ°μ΄ν„°
    timer_startTime: 1760502130128,    // μ„λ²„ μ‹μ‘ μ‹κ°„
    timer_pausedTime: 156,             // μ •μ§€λ μ‹κ°„
    timer_isRunning: true,             // μ‹¤ν–‰ μƒνƒ
    timer_lastUpdate: 1760502130128    // λ§μ§€λ§‰ μ—…λ°μ΄νΈ μ‹κ°„
}
```

### λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥/λ³µμ› λ΅μ§
```javascript
// μ €μ¥
async saveToDatabase(matchId) {
    const match = await Match.findByPk(matchId);
    const state = this.timerStates.get(matchId);
    const matchData = { ...match.match_data };
    
    matchData.timer_startTime = state.startTime;
    matchData.timer_pausedTime = state.pausedTime;
    matchData.timer_isRunning = state.isRunning;
    matchData.timer_lastUpdate = state.lastUpdate;
    
    await match.update({ match_data: matchData });
}

// λ³µμ›
async restoreFromDatabase(matchId) {
    const match = await Match.findByPk(matchId);
    const matchData = match.match_data;
    
    const restoredState = {
        startTime: matchData.timer_startTime || null,
        pausedTime: matchData.timer_pausedTime || 0,
        isRunning: matchData.timer_isRunning || false,
        lastUpdate: matchData.timer_lastUpdate || null
    };
    
    this.timerStates.set(matchId, restoredState);
    return restoredState;
}
```

## π”„ ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ™κΈ°ν™”

### λ™κΈ°ν™” λ©”μ»¤λ‹μ¦
1. **μ΄κΈ° μ—°κ²° μ‹**: `request_timer_state` μ΄λ²¤νΈλ΅ μ„λ²„ μƒνƒ μ”μ²­
2. **μ‹¤μ‹κ°„ μ—…λ°μ΄νΈ**: `timer_state` μ΄λ²¤νΈλ΅ μ„λ²„ μƒνƒ μμ‹ 
3. **λ΅μ»¬ νƒ€μ΄λ¨Έ**: `setInterval`λ΅ 1μ΄λ§λ‹¤ λ΅μ»¬ μ‹κ°„ μ—…λ°μ΄νΈ
4. **μƒνƒ λ™κΈ°ν™”**: μ„λ²„ μƒνƒμ™€ λ΅μ»¬ μƒνƒλ¥Ό μ£ΌκΈ°μ μΌλ΅ λ™κΈ°ν™”

### λ™κΈ°ν™” μ½”λ“ μμ‹
```javascript
// ν΄λΌμ΄μ–ΈνΈ μΈ΅ λ™κΈ°ν™”
socket.on('timer_state', function(data) {
    currentTime = data.currentSeconds || 0;
    isRunning = data.isRunning || false;
    updateTimerDisplay();
    
    if (isRunning) {
        startLocalTimer();
    } else {
        stopLocalTimer();
    }
});

// λ΅μ»¬ νƒ€μ΄λ¨Έ μ—…λ°μ΄νΈ
function startLocalTimer() {
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        if (isRunning) {
            currentTime++;
            updateTimerDisplay();
        }
    }, 1000);
}
```

## π“ νƒ€μ΄λ¨Έ μƒνƒ κ΄€λ¦¬

### μƒνƒ μ „ν™ λ‹¤μ΄μ–΄κ·Έλ¨
```
[μ΄κΈ° μƒνƒ] β†’ [μ‹μ‘] β†’ [μ‹¤ν–‰ μ¤‘] β†’ [μ •μ§€] β†’ [μ‹μ‘] β†’ [μ‹¤ν–‰ μ¤‘]
     β†“           β†“         β†“         β†“         β†“         β†“
  00:00      startTimer  μ§„ν–‰ μ¤‘   stopTimer  startTimer  μ§„ν–‰ μ¤‘
     β†“           β†“         β†“         β†“         β†“         β†“
  resetTimer  startTime  currentTime pausedTime startTime currentTime
     β†“           β†“         β†“         β†“         β†“         β†“
  00:00      μ„λ²„ μ‹κ°„    λ΅μ»¬ μ¦κ°€   μ •μ§€ μ‹κ°„   μ„λ²„ μ‹κ°„   λ΅μ»¬ μ¦κ°€
```

### μƒνƒ κ΄€λ¦¬ λ΅μ§
```javascript
// μ‹μ‘ μ‹
startTimer(matchId, io) {
    const serverTime = Date.now();
    const currentState = this.timerStates.get(matchId);
    const pausedTime = currentState ? currentState.pausedTime : 0;
    
    this.timerStates.set(matchId, {
        startTime: serverTime,
        pausedTime: pausedTime,  // κΈ°μ΅΄ μ •μ§€ μ‹κ°„ μ μ§€
        isRunning: true,
        lastUpdate: serverTime
    });
}

// μ •μ§€ μ‹
stopTimer(matchId, io) {
    const state = this.timerStates.get(matchId);
    if (state && state.isRunning) {
        const serverTime = Date.now();
        const elapsed = Math.floor((serverTime - state.startTime) / 1000);
        state.pausedTime += elapsed;  // μ •μ§€ μ‹κ°„ λ„μ 
        state.isRunning = false;
        state.lastUpdate = serverTime;
    }
}
```

## π› οΈ μ¤λ¥ μ²λ¦¬ λ° λ³µκµ¬

### μ¤λ¥ μ²λ¦¬ λ©”μ»¤λ‹μ¦
1. **WebSocket μ—°κ²° μ‹¤ν¨**: μλ™ μ¬μ—°κ²° μ‹λ„
2. **μ„λ²„ μ‘λ‹µ μ—†μ**: μ£ΌκΈ°μ  μƒνƒ μ”μ²­
3. **λ°μ΄ν„°λ² μ΄μ¤ μ¤λ¥**: λ©”λ¨λ¦¬ μƒνƒ μ μ§€
4. **ν΄λΌμ΄μ–ΈνΈ μ¤λ¥**: μ„λ²„ μƒνƒλ΅ λ³µμ›

### λ³µκµ¬ μ½”λ“ μμ‹
```javascript
// μ—°κ²° μ‹¤ν¨ μ‹ μ¬μ‹λ„
socket.on('disconnect', () => {
    console.log('μ—°κ²° ν•΄μ , μ¬μ—°κ²° μ‹λ„...');
    setTimeout(() => {
        socket.connect();
    }, 1000);
});

// μ„λ²„ μƒνƒ μ”μ²­ (μ¬μ—°κ²° μ‹)
socket.on('connect', () => {
    socket.emit('request_timer_state', { matchId: matchId });
});
```

## β΅ μ„±λ¥ μµμ ν™”

### μµμ ν™” μ „λµ
1. **λ©”λ¨λ¦¬ κΈ°λ° μƒνƒ κ΄€λ¦¬**: `global.serverTimerStates` μ‚¬μ©
2. **μ£ΌκΈ°μ  λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥**: μƒνƒ λ³€κ²½ μ‹μ—λ§ μ €μ¥
3. **ν¨μ¨μ μΈ λΈλ΅λ“μΊμ¤νΈ**: ν•„μ”ν• ν΄λΌμ΄μ–ΈνΈμ—κ²λ§ μ „μ†΅
4. **λ΅μ»¬ νƒ€μ΄λ¨Έ μµμ ν™”**: 1μ΄ κ°„κ²©μΌλ΅ μ—…λ°μ΄νΈ

### μ„±λ¥ λ¨λ‹ν„°λ§
```javascript
// νƒ€μ΄λ¨Έ μƒνƒ μ „μ†΅ λ΅κ·Έ
console.log(`μ„λ²„ νƒ€μ΄λ¨Έ μƒνƒ μ „μ†΅: matchId=${matchId}, currentSeconds=${currentTime}, isRunning=${state.isRunning}`);

// λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥ λ΅κ·Έ
console.log(`μ„λ²„ νƒ€μ΄λ¨Έ DB μ €μ¥ μ™„λ£: matchId=${matchId}`);

// ν΄λΌμ΄μ–ΈνΈ μƒνƒ μ—…λ°μ΄νΈ λ΅κ·Έ
console.log('νƒ€μ΄λ¨Έ μƒνƒ μ—…λ°μ΄νΈ:', { currentTime, isRunning });
```

## π§ ν…μ¤νΈ λ° κ²€μ¦

### ν…μ¤νΈ μ‹λ‚λ¦¬μ¤
1. **κΈ°λ³Έ κΈ°λ¥ ν…μ¤νΈ**
   - νƒ€μ΄λ¨Έ μ‹μ‘/μ •μ§€/λ¦¬μ…‹
   - μ‹κ°„ μμ • λ° μ μ©
   - μ‹¤μ‹κ°„ λ™κΈ°ν™”

2. **μ§€μ†μ„± ν…μ¤νΈ**
   - μ„λ²„ μ¬μ‹μ‘ ν›„ μƒνƒ λ³µμ›
   - νμ΄μ§€ μƒλ΅κ³ μΉ¨ ν›„ μƒνƒ λ³µμ›
   - λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥/λ³µμ›

3. **λ™κΈ°ν™” ν…μ¤νΈ**
   - μ»¨νΈλ΅¤ νμ΄μ§€μ™€ μ¤λ²„λ μ΄ νμ΄μ§€ λ™κΈ°ν™”
   - λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ™κΈ°ν™”
   - λ„¤νΈμ›ν¬ μ§€μ—° μ‹ λ™κΈ°ν™”

### κ²€μ¦ κ²°κ³Ό
- β… **νƒ€μ΄λ¨Έ μ •μ§€ ν›„ μ‹μ‘**: μ •μ§€λ μ‹κ°„μ—μ„ μ •μƒ μ¬μ‹μ‘
- β… **νƒ€μ΄λ¨Έ μμ • ν›„ μ‹μ‘**: μμ •λ μ‹κ°„μ—μ„ μ •μƒ μ‹μ‘
- β… **μ„λ²„ μ¬μ‹μ‘ ν›„ λ³µμ›**: νƒ€μ΄λ¨Έ μƒνƒ μ •μƒ λ³µμ›
- β… **μ‹¤μ‹κ°„ λ™κΈ°ν™”**: μ»¨νΈλ΅¤/μ¤λ²„λ μ΄ νμ΄μ§€ μ™„λ²½ λ™κΈ°ν™”
- β… **μ§€μ†μ„± λ³΄μ¥**: νμ΄μ§€ μƒλ΅κ³ μΉ¨ ν›„ μƒνƒ μ μ§€

## π“ κ²°λ΅ 

### κµ¬ν„λ ν•µμ‹¬ κΈ°λ¥
1. **μ„λ²„ μ¤‘μ‹¬ νƒ€μ΄λ¨Έ μ‹μ¤ν…**: μ„λ²„κ°€ μ μΌν• μ‹κ°„ κΈ°μ¤€
2. **μ‹¤μ‹κ°„ WebSocket ν†µμ‹ **: μ–‘λ°©ν–¥ μ‹¤μ‹κ°„ λ™κΈ°ν™”
3. **λ°μ΄ν„°λ² μ΄μ¤ μμ†μ„±**: SQLite/PostgreSQLμ„ ν†µν• μƒνƒ μ €μ¥
4. **ν¬λ΅μ¤ ν”λ«νΌ μ§€μ›**: λ‹¤λ¥Έ PCμ—μ„λ„ λ™μΌν• νƒ€μ΄λ¨Έ μƒνƒ
5. **μ¤λ¥ λ³µκµ¬**: μ—°κ²° μ‹¤ν¨ μ‹ μλ™ λ³µκµ¬

### κΈ°μ μ  μ¥μ 
- **λ‹¨μμ„±**: λ³µμ΅ν• ν΄λΌμ΄μ–ΈνΈ λ΅μ§ μ κ±°
- **μ•μ •μ„±**: μ„λ²„ μ¤‘μ‹¬μ μΌκ΄€λ μƒνƒ κ΄€λ¦¬
- **ν™•μ¥μ„±**: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ μ§€μ›
- **μ§€μ†μ„±**: μ„λ²„ μ¬μ‹μ‘ ν›„μ—λ„ μƒνƒ μ μ§€

### ν–¥ν›„ κ°μ„  λ°©ν–¥
1. **μ„±λ¥ μµμ ν™”**: λ€μ©λ‰ λ™μ‹ μ ‘μ† μ§€μ›
2. **λ¨λ‹ν„°λ§**: μ‹¤μ‹κ°„ μƒνƒ λ¨λ‹ν„°λ§ μ‹μ¤ν…
3. **λ°±μ—…**: μλ™ λ°±μ—… λ° λ³µμ› μ‹μ¤ν…
4. **λ΅κΉ…**: μƒμ„Έν• λ΅κ·Έ λ° λ¶„μ„ μ‹μ¤ν…

μ΄ νƒ€μ΄λ¨Έ μ‹μ¤ν…μ€ SportsCoder ν”„λ΅μ νΈμ ν•µμ‹¬ κΈ°λ¥μΌλ΅, μ•μ •μ μ΄κ³  ν™•μ¥ κ°€λ¥ν• μ‹¤μ‹κ°„ νƒ€μ΄λ¨Έ μ„λΉ„μ¤λ¥Ό μ κ³µν•©λ‹λ‹¤.
